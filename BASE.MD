UI/UX (componentes obligatorios)

Ventas: VentaForm, EntregaWidget, DeudaChip + AbonoDialog, VentasTable (filtros y export).

OC/Recepciones/Distribuidores: OCForm, RecepcionForm, DistribuidorList, PagoProveedorDialog.

Bancos: BankSummary, BankOps (gasto/transfer), BankLedgerTable.

Buckets: BucketKPI (HistÃ³rico/Capital), BucketTimeline (entradas/salidas).

Transferencias: BankTransferDialog, BucketReclassDialog.

Gastos: ExpenseForm (con autosuggest IA de conceptos).

Reportes: Flete cobrado vs real, ventas con pÃ©rdida, rotaciÃ³n, antigÃ¼edad de deudas clientes/proveedores (export CSV/Parquet).

Refresco automÃ¡tico tras cada operaciÃ³n (SSE/WS o invalidaciÃ³n reactiva).

CHECKLIST DE VERIFICACIÃ“N (componente por componente)
Ventas

 VentaForm: muestra/oculta monto_abono sÃ³lo si PARCIAL. Valida qty>0, pvTotal â‰¥ 0, fleteUnit â‰¥ 0.

 EntregaWidget: bloquea si stock insuficiente; calcula y pinta FL/BM/UT; al confirmar â†’ baja stock + HistÃ³rico â†‘ (cards BM/FL/UT). Capital no cambia.

 AbonoDialog: ingresa en banco; distribuye FLâ†’BMâ†’UT (manual/proporcional); Capital sube segÃºn distribuciÃ³n; Deuda cliente baja.

Distribuidores

 OCForm: crea deuda proveedor; RecepcionForm sube stock; DistribuidorList muestra deuda (Producto/Transporte).

 PagoProveedorDialog: selecciona banco; bucket BM/FL segÃºn tipo; saldo proveedor baja; bank_ledger/bucket_ledger registran egreso.

Bancos/Buckets

 BankOps â†’ Gasto: banco OUT; si bucketâ‰ NA â†’ bucket.capital baja (o registra OUT segÃºn polÃ­tica).

 BankOps â†’ Transferencia: Bancoâ†”Banco; ledger OUT/IN; no toca buckets.

 BucketReclassDialog: bucket_fromâ†’bucket_to; ledger de bucket; no toca bancos.

Reportes

 Flete cobrado vs real = (500Ã—u entregadas) â€“ Î£ CT_real pagado.

 Ventas con pÃ©rdida: PV_total < FL + BM.

 RotaciÃ³n: dÃ­as de cobertura + salidas por periodo.

 AntigÃ¼edad de deuda: clientes y distribuidores.

Visual/UX

 Cards HistÃ³rico suben al Entregar; Capital sube al Cobro/Abonos.

 Cada operaciÃ³n dispara refresco (SSE/React Query invalidate).

 Export CSV/Parquet en tablas clave.

TESTS AUTOMÃTICOS (ejecuta todos; si falla, corrige y reintenta)
Unit (helpers puros)

calcDistribution:

PV<FL â‡’ {FL=PV,BM=0,UT=0}

PVâ‰ˆFL+BM â‡’ UTâ‰ˆ0

PVâ‰«FL+BM â‡’ UT>0

Varias combinaciones de CP y unidades.

Integration (back)

Entrega: valida stockâ†“, HistÃ³rico â†‘ (BM/FL/UT) y Capital sin cambios.

Cobro Parcial: bank IN; distribuciÃ³n FLâ†’BMâ†’UT; Capital sube y Deuda baja.

Pago Proveedor: reduce distributor_debt; bank OUT; bucket OUT (BM/FL).

Transfer Bancoâ†”Banco: bank_from OUT / bank_to IN; buckets intactos.

ReclasificaciÃ³n Bucketâ†”Bucket: capital mueve; bancos intactos.

Gasto: bank OUT; bucket OUT (si â‰ NA).

E2E (Playwright)

Crear OCâ†’RecepciÃ³nâ†’Venta PENDIENTEâ†’Entregaâ†’Ver HistÃ³ricoâ†’Abono Parcialâ†’Ver Capital y deuda.

Pago a Distribuidor (Producto y Transporte) con banco/bucket correctos.

Transferencias (bancos/buckets) y Gastos con ledger correcto.

Reportes correctos; export funcional.

A11y/Perf (Lighthouse/axe)

LCP < 2.0s, INP p95 < 200ms, axe sin crÃ­ticos, focus visible en formularios y botones.

POLÃTICA DE REPARACIÃ“N

Si una aserciÃ³n falla: imprime archivo:lÃ­nea + razÃ³n y sugiere diff (patch).

Aplica patch y re-ejecuta el bloque hasta â€œverdeâ€.

Si falta un formulario o ruta: crÃ©alo con implementaciÃ³n mÃ­nima real + test asociado.

Si hay ambigÃ¼edad en â€œHistÃ³rico vs Capitalâ€: respeta la regla:

HistÃ³rico: sube al Entregar.

Capital: sube al Cobrar/Abonos (cliente) o al registrar egresos/transferencias (bancos/buckets).

ENTREGABLES AL CIERRE (obligatorios)

Build/Type/Lint/Tests: verde, sin warnings crÃ­ticos.

UI: todos los paneles y componentes funcionan; cambios reflejados en vivo.

Datos: ledger bancos y buckets consistente; stock nunca negativo; deudas correctas.

Reportes: mÃ©tricas correctas; export activo.

README de verificaciÃ³n: lista de checks y capturas del flujo E2E.

EJECUCIÃ“N

Corre los checks, corrige hasta verde, devuÃ©lveme:

Resumen de fallos hallados y patches aplicados.

Capturas/artefactos (si procede).

ConfirmaciÃ³n de que todas las aserciones quedaron en verde.

Objetivo final: sistema perfecto, robusto, limpio y funcional, con toda la lÃ³gica BM/FL/UT, Bancos Azteca/Leftie/Profit, Deudas (clientes/proveedores), Transferencias y Gastos, cumpliendo exactamente tu comportamiento de HistÃ³rico vs Capital y refresco automÃ¡tico por panel.
Venta y Entrega

Regla de histÃ³rico vs capital al entregar y al cobrar/abonar (confirma que histÃ³rico sube en entrega, capital sube al cobro).

Estados de pago aceptados (PAGADO, PENDIENTE, PARCIAL) y visibilidad de campos (monto de abono en PARCIAL).

Reglas edge (PV<FL; PV<FL+BM) y mensajes al operador.

OC / Recepciones / Distribuidores

CÃ³mo registras CP y CT_real (y si CT_real siempre va a FL).

Flujo de deuda con distribuidor (por OC), abonos/pagos (selecciÃ³n de banco y bucket BM/FL).

Si permites pagos a cuenta (sin PO) o sÃ³lo por PO.

Deudas de clientes

MÃ©todo de asignaciÃ³n de abonos (manual vs proporcional FLâ†’BMâ†’UT).

Reglas de cierre de deuda y reportes de antigÃ¼edad.

Bancos y Buckets

Bancos disponibles (Profit, Azteca, Leftieâ€¦).

Buckets (BM, FL, UT) â€” si capital disminuye con gastos o sÃ³lo muestras histÃ³rico (+ cÃ³mo prefieres verlo).

Transferencias y Reclasificaciones

Bancoâ†”Banco (liquidez real).

Bucketâ†”Bucket (reclasificaciÃ³n interna).

Bancoâ†”Bucket (Â¿quieres asignaciones â€œreservasâ€ o lo evitamos para no duplicar?).

Validaciones y KPIs â€œantes/despuÃ©sâ€.

Gastos

Campos (banco, bucket, monto, concepto, descripciÃ³n).

CatÃ¡logo de conceptos (si quieres autosuggest IA y normalizaciÃ³n).

Reportes clave

Flete cobrado vs flete real, ventas con pÃ©rdida, rotaciÃ³n de inventario, flujo por banco/bucket, antigÃ¼edad de deudas (clientes y distribuidores).

IA Generativa (UI autoaprendizaje)

QuÃ© quieres que aprenda/adapte (conceptos, orden de campos, plantillas, taxonomÃ­as).

Nivel de automatizaciÃ³n (sÃ³lo sugerir vs aplicar layout si cruza umbral).

Privacidad (opt-in/opt-out).

Restricciones/Preferencias

FIFO vs Promedio Ponderado para salida de stock.

LÃ­mites o polÃ­ticas internas (montos mÃ¡ximos, 2-man rule, MFA en egresos).

Lo que no quieres que haga el sistema automÃ¡ticamente.
ðŸŽ¨ Blueprint Â· UI/UX Supremo

1. FilosofÃ­a de DiseÃ±o

Estilo: Dark-mode premium, glassmorphism + neÃ³n sutil + gradients animados.

SensaciÃ³n: inmersiva, futurista, con feedback hÃ¡ptico visual/sonoro.

Meta: que el usuario sienta que opera un centro de control hologrÃ¡fico.

2. Componentes Base

Cada panel tendrÃ¡:

Cards dinÃ¡micas con mÃ©tricas â†’ Glow reactivo al cursor.

Charts GPU (deck.gl / regl) â†’ transiciones suaves al actualizar datos.

HUD superior â†’ navegaciÃ³n global + comandos de voz + IA asistente.

Timeline animado â†’ entradas/salidas (ventas, abonos, pagos distribuidor).

Radial Menu â†’ acceso rÃ¡pido con click-hold + animaciÃ³n radial 3D.

3. Micro-animaciones y Transiciones

Hover 3D tilt: cards y botones con inclinaciÃ³n sutil segÃºn cursor.

Transitions: fade+scale (150â€“250ms), cubic-bezier suaves.

Feedback: glow azul al Ã©xito, vibraciÃ³n visual roja al error.

Cursor reactive particles: partÃ­culas sutiles que siguen el puntero en dashboards.

Canvas FX: shaders (bloom, SSAO, DOF) para fondos dinÃ¡micos.

4. Interactividad Avanzada

Drag-and-drop: para reclasificar buckets y mover fondos.

Context-menus flotantes: click derecho en registros â†’ â€œtransferirâ€, â€œeditarâ€, â€œsaldarâ€.

Search omnibar (âŒ˜K) â†’ bÃºsqueda de clientes, distribuidores, operaciones.

Charts interactivos: zoom con scroll, scrub temporal, highlight por hover.

Replay modo pelÃ­cula: reproducir flujos de ventas/abonos como animaciÃ³n.

5. NavegaciÃ³n Inteligente

SPA fluida (Next.js App Router).

Transitions entre vistas: morphing de grÃ¡ficos (ej: stockâ†’ventas).

Voice HUD (Jarvis):

ActivaciÃ³n â€œHey Shadowâ€.

Preguntas tipo: â€œÂ¿CuÃ¡nto debo al distribuidor X?â€ â†’ dashboard se ajusta y responde con visual.

Comandos directos: â€œRegistrar gasto 500 USD en Azteca, concepto gasolinaâ€.

6. IntegraciÃ³n con IA Jarvis-like

Conversacional multimodal:

Voz â†’ texto (Whisper).

Texto â†’ acciÃ³n (LangChain + agentes).

AcciÃ³n â†’ UI (React state sync).

Explicativo:

Al registrar una venta, la IA explica cÃ³mo se distribuyÃ³:
â€œ8 unidades: FL=4000, BM=3200, UT=800. Capital reflejado en histÃ³rico, capital real pendiente de cobro.â€

Predictivo:

IA sugiere patrones: â€œDetecto que sueles usar concepto Gasolina en gastos, Â¿quieres autocompletarlo?â€.

7. Paneles / Flujos

Distribuidores:

Perfil con deuda acumulada, timeline de OCs.

BotÃ³n â€œPagarâ€ con selecciÃ³n de banco/bucket.

AlmacÃ©n:

Stock dinÃ¡mico, entradas verdes, salidas rojas.

AnimaciÃ³n â€œfade-slideâ€ al actualizar.

Ventas:

Form con validaciÃ³n dinÃ¡mica (estado pago).

Entrega â†’ animaciÃ³n Sankey mostrando FL/BM/UT.

Buckets BM/FL/UT:

Card HistÃ³rico (â†‘ siempre).

Card Capital (sube con abonos).

Timeline con â€œIN/OUTâ€ animado.

Bancos Azteca/Leftie/Profit:

Capital + Transferencias + Gastos.

Heatmap de movimientos.

Reportes:

KPI cards con animaciÃ³n â€œcount upâ€.

Charts GPU comparativos.

8. Experiencia CinemÃ¡tica

Hero scene inicial:

3D holograma rotando (glTF) con KPIs flotando.

MÃºsica/sfx suaves.

Modo demostraciÃ³n:

Reproduce transacciones como pelÃ­cula (ventas/abonos/transferencias) en timeline 3D.

Unreal Engine export:

Genera cinemÃ¡ticas .webm para marketing/demo.

9. TecnologÃ­as Top-1

Frontend: Next.js 14 + R3F/WebGPU + Tailwind/shadcn/ui + Framer Motion.

Visual FX: Drei, GLSL shaders, Particles.js, Rive (micro-motions).

IA HUD: LangChain + Whisper + LLM (OpenAI/Mistral/Claude) + vector DB.

UI State: Zustand/Recoil.

PWA offline + Edge SSR (Vercel).
ðŸ“¦ Contenido del Starter-Kit UI
Estructura
/flowdistributor-ui
  /app
    /layout.tsx
    /page.tsx
    /(ops)/
      ventas/page.tsx
      distribuidores/page.tsx
      almacÃ©n/page.tsx
      bancos/page.tsx
      reportes/page.tsx
      transferencias/page.tsx
      gastos/page.tsx
  /components
    Dashboard.tsx
    DistributorPanel.tsx
    OCForm.tsx
    VentaForm.tsx
    AbonoForm.tsx
    TransferForm.tsx
    GastoForm.tsx
    CapitalCard.tsx
    Timeline.tsx
    VoiceHUD.tsx
    RadialMenu.tsx
  /lib
    state.ts (Zustand global state)
    api.ts (conexiÃ³n REST/WS)
  /styles
    tokens.css
  /public
    hero.glb
    bg-shaders.frag

Stack

Next.js 14 (App Router, React Server Components)

TailwindCSS 3.4 + shadcn/ui

Framer Motion + R3F/WebGPU (animaciones + 3D interactivo)

Zustand (state management global)

LangChain + Whisper API (IA Jarvis-like por voz)

Deck.gl/Mapbox (mapas y visualizaciÃ³n avanzada)

ðŸŽ¨ DiseÃ±o UI/UX

Dark mode premium con glassmorphism + neÃ³n sutil.

Cards dinÃ¡micas: muestran capital histÃ³rico y capital actual.

Animaciones: micro-interacciones (hover glow, tilt 3D, transitions suaves).

Timeline animado: todas las operaciones (OC, ventas, abonos, pagos, gastos, transferencias).

Voice HUD Jarvis-like:

â€œRegistrar venta de 10 unidades a cliente X, pagado parcial $5000â€.

â€œMostrar deudas con Distribuidor Yâ€.

â€œTransferir $2000 de BM a Aztecaâ€.

Replay mode: animaciÃ³n de operaciones como pelÃ­cula.

Hero scene inicial: holograma 3D girando con KPIs flotantes.

ðŸ§® LÃ³gica incorporada en UI

Distribuidores

Registro automÃ¡tico con cada OC.

Panel de deuda + formulario de abono.

SelecciÃ³n de banco origen al pagar deuda.

AlmacÃ©n

Entrada stock por OC.

Salida stock por ventas.

HistÃ³rico de entradas/salidas.

Ventas

Formulario â†’ Cliente + estado pago (pagado, parcial, no pagado).

CÃ¡lculo FL (500*u), BM (Î£CP), UT (PVâˆ’FLâˆ’BM).

Reflejo automÃ¡tico en BM/FL/UT:

HistÃ³rico siempre â†‘.

Capital solo â†‘ cuando cliente paga.

Deudas clientes

Panel de cliente con saldo.

BotÃ³n abono â†’ selecciona banco origen.

Bancos (BM, FL, UT, Azteca, Leftie, Profit)

Cards: HistÃ³rico + Capital.

Formularios: Transferencias + Gastos.

Registros trazables:

Transferencia: de â†’ a + concepto + descripciÃ³n.

Gasto: concepto + descripciÃ³n + monto.
